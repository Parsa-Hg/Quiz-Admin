<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª Ø¢Ø²Ù…ÙˆÙ†</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="theme-color" content="#007AFF">
    <link rel="apple-touch-icon" href="icon.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --bg: #F2F2F7; --card: #FFFFFF; --text: #000000;
            --sub-text: #8A8A8E; --blue: #007AFF; --border: #C6C6C8; --red: #FF3B30;
        }
        body.dark-mode {
            --bg: #000000; --card: #1C1C1E; --text: #FFFFFF;
            --sub-text: #98989F; --blue: #0A84FF; --border: #38383A;
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Tahoma, sans-serif;
            background-color: var(--bg); color: var(--text); margin: 0; padding: 20px; transition: 0.3s;
            user-select: none;
        }
        .container { max-width: 500px; margin: auto; }
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; }
        
        /* Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ */
        .card { background: var(--card); border-radius: 20px; padding: 20px; margin-bottom: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); position: relative; }
        
        /* Ø§ÛŒÙ†Ù¾ÙˆØªâ€ŒÙ‡Ø§ */
        label { display: block; margin-bottom: 8px; font-weight: 600; font-size: 0.9rem; color: var(--sub-text); }
        input, textarea {
            width: 100%; padding: 14px; border-radius: 12px; border: 1px solid var(--border);
            background: var(--bg); color: var(--text); margin-bottom: 15px; font-family: inherit; font-size: 1rem; outline: none;
        }
        input:focus { border-color: var(--blue); }

        /* Ø¨Ø®Ø´ Ø³ÙˆØ§Ù„Ø§Øª */
        .q-box { border-right: 5px solid var(--blue); }
        .delete-q { position: absolute; left: 15px; top: 15px; color: var(--red); cursor: pointer; padding: 5px; }

        /* Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ */
        .btn {
            width: 100%; padding: 16px; border-radius: 16px; border: none;
            font-weight: bold; font-size: 1rem; cursor: pointer; transition: 0.2s;
            display: flex; align-items: center; justify-content: center; gap: 10px;
        }
        .btn-blue { background: var(--blue); color: white; box-shadow: 0 4px 12px rgba(0,122,255,0.3); }
        .btn-outline { background: transparent; border: 2px solid var(--blue); color: var(--blue); margin-top: 10px; }
        .btn-red { background: transparent; border: 1px solid var(--red); color: var(--red); margin-top: 20px; }
        
        /* Ù†Ù…Ø§ÛŒØ´ Ù„ÛŒÙ†Ú© */
        .link-display {
            background: var(--bg); padding: 15px; border-radius: 12px;
            word-break: break-all; font-family: monospace; font-size: 0.85rem;
            margin: 20px 0; border: 1px dashed var(--blue); color: var(--blue);
        }

        .hidden { display: none !important; }
        .welcome-section { text-align: center; padding: 40px 0; }
        .welcome-icon { font-size: 5rem; color: var(--blue); margin-bottom: 20px; opacity: 0.9; }
    </style>
</head>
<body>

    <div class="container">
        <div class="header">
            <h2 id="main-title">Ù…Ø¯ÛŒØ±ÛŒØª Ø¢Ø²Ù…ÙˆÙ†</h2>
            <button onclick="toggleTheme()" style="background:none; border:none; color:var(--blue); font-size:1.4rem;">
                <i class="fas fa-adjust"></i>
            </button>
        </div>

        <div id="page-home" class="welcome-section">
            <div class="welcome-icon"><i class="fas fa-scroll"></i></div>
            <h3>Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯ØŒ Ø§Ø³ØªØ§Ø¯</h3>
            <p style="color:var(--sub-text); margin-bottom: 30px;">Ø¨Ø±Ø§ÛŒ Ø·Ø±Ø§Ø­ÛŒ Ø¢Ø²Ù…ÙˆÙ† Ø¬Ø¯ÛŒØ¯ Ùˆ Ø§Ø±Ø³Ø§Ù„ Ø¨Ø±Ø§ÛŒ Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²Ø§Ù† Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ§ÛŒØ¯ØŸ</p>
            <button class="btn btn-blue" onclick="showPage('page-create')">
                <i class="fas fa-plus"></i> Ø§ÛŒØ¬Ø§Ø¯ Ø¢Ø²Ù…ÙˆÙ† Ø¬Ø¯ÛŒØ¯
            </button>
        </div>

        <div id="page-create" class="hidden">
            <div class="card">
                <label><i class="fas fa-tag"></i> Ø¹Ù†ÙˆØ§Ù† Ø¢Ø²Ù…ÙˆÙ†</label>
                <input type="text" id="quiz-title" placeholder="Ù…Ø«Ù„Ø§Ù‹: Ø§Ù…ØªØ­Ø§Ù† ØªØ±Ù… Ø§ÙˆÙ„ Ø´ÛŒÙ…ÛŒ">
                
                <label><i class="fas fa-hourglass-half"></i> Ø²Ù…Ø§Ù† Ù…Ø¬Ø§Ø² (Ø¯Ù‚ÛŒÙ‚Ù‡)</label>
                <input type="number" id="quiz-time" placeholder="Ù…Ø«Ù„Ø§Ù‹: 30">
            </div>

            <div id="questions-holder">
                </div>

            <button class="btn btn-outline" onclick="addNewQuestion()">
                <i class="fas fa-plus-circle"></i> Ø§ÙØ²ÙˆØ¯Ù† Ø³ÙˆØ§Ù„ Ø¬Ø¯ÛŒØ¯
            </button>
            
            <button class="btn btn-blue" style="margin-top:40px;" onclick="finishAndGenerate()">
                <i class="fas fa-rocket"></i> Ù†Ù‡Ø§ÛŒÛŒâ€ŒØ³Ø§Ø²ÛŒ Ùˆ Ø¯Ø±ÛŒØ§ÙØª Ù„ÛŒÙ†Ú©
            </button>
            <button class="btn btn-red" style="border:none" onclick="showPage('page-home')">Ø§Ù†ØµØ±Ø§Ù Ùˆ Ø¨Ø§Ø²Ú¯Ø´Øª</button>
        </div>

        <div id="page-result" class="hidden">
            <div class="card" style="text-align: center;">
                <i class="fas fa-check-circle" style="font-size: 4rem; color: var(--blue); margin-bottom: 15px;"></i>
                <h3>Ø¢Ø²Ù…ÙˆÙ† Ø´Ù…Ø§ Ø¢Ù…Ø§Ø¯Ù‡ Ø´Ø¯!</h3>
                <p style="color:var(--sub-text); font-size: 0.9rem;">Ù„ÛŒÙ†Ú© Ø²ÛŒØ± Ø±Ø§ Ú©Ù¾ÛŒ Ú©Ø±Ø¯Ù‡ Ùˆ Ø¨Ø±Ø§ÛŒ Ø´Ø±Ú©Øªâ€ŒÚ©Ù†Ù†Ø¯Ú¯Ø§Ù† Ø¨ÙØ±Ø³ØªÛŒØ¯.</p>
                
                <div id="output-link" class="link-display"></div>
                
                <button class="btn btn-blue" onclick="copyLink()">
                    <i class="fas fa-copy"></i> Ú©Ù¾ÛŒ Ù„ÛŒÙ†Ú© Ø¢Ø²Ù…ÙˆÙ†
                </button>
                
                <button class="btn btn-outline" style="margin-top:15px" onclick="showPage('page-home')">
                    <i class="fas fa-home"></i> Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯
                </button>
            </div>
        </div>
    </div>

    <script>
        // ğŸ”— Ù…Ù‡Ù…: Ø¢Ø¯Ø±Ø³ Ø³Ø§ÛŒØª Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ² Ø±Ø§ Ø§ÛŒÙ†Ø¬Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯
        const STUDENT_APP_URL = "https://quiz-students-89.netlify.app/";

        function showPage(pageId) {
            document.getElementById('page-home').classList.add('hidden');
            document.getElementById('page-create').classList.add('hidden');
            document.getElementById('page-result').classList.add('hidden');
            document.getElementById(pageId).classList.remove('hidden');

            if(pageId === 'page-create' && document.getElementById('questions-holder').children.length === 0) {
                addNewQuestion();
            }
        }

        function addNewQuestion() {
            const holder = document.getElementById('questions-holder');
            const qID = Date.now();
            const qDiv = document.createElement('div');
            qDiv.className = 'card q-box';
            qDiv.id = `q-container-${qID}`;
            qDiv.innerHTML = `
                <i class="fas fa-trash-alt delete-q" onclick="deleteQuestion('q-container-${qID}')"></i>
                <label>ØµÙˆØ±Øª Ø³ÙˆØ§Ù„:</label>
                <input type="text" class="inp-text" placeholder="Ø³ÙˆØ§Ù„ Ø±Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯">
                <label>Ø´Ù…Ø§Ø±Ù‡ Ú¯Ø²ÛŒÙ†Ù‡ ØµØ­ÛŒØ­:</label>
                <input type="number" class="inp-correct" placeholder="Ù…Ø«Ù„Ø§Ù‹: 1">
                <label>Ú¯Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ (Ù‡Ø± Ú©Ø¯Ø§Ù… Ø¯Ø± ÛŒÚ© Ø®Ø·):</label>
                <textarea class="inp-options" rows="3" placeholder="Ú¯Ø²ÛŒÙ†Ù‡ Ø§ÙˆÙ„&#10;Ú¯Ø²ÛŒÙ†Ù‡ Ø¯ÙˆÙ…..."></textarea>
            `;
            holder.appendChild(qDiv);
        }

        function deleteQuestion(id) {
            if(confirm("Ø§ÛŒÙ† Ø³ÙˆØ§Ù„ Ø­Ø°Ù Ø´ÙˆØ¯ØŸ")) {
                document.getElementById(id).remove();
            }
        }

        function finishAndGenerate() {
            const title = document.getElementById('quiz-title').value;
            const time = document.getElementById('quiz-time').value;
            const qElements = document.querySelectorAll('.q-box');
            const finalQuestions = [];

            if(!title || !time) return alert("Ù„Ø·ÙØ§Ù‹ Ø¹Ù†ÙˆØ§Ù† Ùˆ Ø²Ù…Ø§Ù† Ø¢Ø²Ù…ÙˆÙ† Ø±Ø§ ØªÚ©Ù…ÛŒÙ„ Ú©Ù†ÛŒØ¯");

            qElements.forEach(el => {
                const text = el.querySelector('.inp-text').value;
                const correct = el.querySelector('.inp-correct').value;
                const options = el.querySelector('.inp-options').value.split('\n').filter(o => o.trim() !== "");

                if(text && correct && options.length >= 2) {
                    finalQuestions.push({
                        t: text,
                        o: options,
                        c: parseInt(correct) - 1
                    });
                }
            });

            if(finalQuestions.length === 0) return alert("Ø­Ø¯Ø§Ù‚Ù„ ÛŒÚ© Ø³ÙˆØ§Ù„ Ù…Ø¹ØªØ¨Ø± Ø¨Ø³Ø§Ø²ÛŒØ¯");

            // Ø¨Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
            const quizData = { title, time, questions: finalQuestions, id: Date.now() };
            const encodedData = btoa(unescape(encodeURIComponent(JSON.stringify(quizData))));
            
            const finalLink = `${STUDENT_APP_URL}/?data=${encodedData}`;
            document.getElementById('output-link').innerText = finalLink;
            showPage('page-result');
        }

        function copyLink() {
            const text = document.getElementById('output-link').innerText;
            navigator.clipboard.writeText(text).then(() => alert("âœ… Ù„ÛŒÙ†Ú© Ø¯Ø± Ú©Ù„ÛŒÙ¾â€ŒØ¨ÙˆØ±Ø¯ Ú©Ù¾ÛŒ Ø´Ø¯."));
        }

        function toggleTheme() {
            document.body.classList.toggle('dark-mode');
            localStorage.setItem('admin-theme', document.body.classList.contains('dark-mode') ? 'dark' : 'light');
        }

        // Ø­ÙØ¸ ØªÙ… Ø§Ù†ØªØ®Ø§Ø¨ÛŒ
        if(localStorage.getItem('admin-theme') === 'dark') {
            document.body.classList.add('dark-mode');
        }
    </script>
</body>
</html>
